---
date : 2019-04-21
title : "Python读写TXT、CSV、XLS文件"
tags : ["Python"]
author : "月光晒谷"
---

### 1.Python读写TXT文件

#### 1.1 写txt文件：

使用`open('output.txt', 'w')`以写的方式打开文件（若文件不存在则创建该文件），使用`file.write()`写入文件，其中参数必须为`str`字符串。

<!--more-->

```Python
with open('output.txt', 'w') as file:
    data = '12\n23 34\n45 56 67'
    file.write(data)
```


#### 1.2 读txt文件：

使用`open('input.txt', 'r')`以读的方式打开.txt文件。使用 `file.readlines()`逐行读取文件,每一行为一个字符串，将读取结果放在一个list中返回。使用`with`语句，可以在该语块结束后自动关闭文件，即相当于`open()`与`close()`语句。


```Python
with open('input.txt', 'r') as file:
    data = file.readlines()
print(data)
print(type(data))
```

```Python
'''输出结果'''
['12\n', '23 34\n', '45 56 67']
<class 'list'>
```


使用 `file.read()`一次读取完整的文件，结果为一个`str`字符串。
```Python
with open('input.txt', 'r') as file:
    data = file.read()
print(data)
print(type(data))
```
```Python
'''输出结果'''
12
23 34
45 56 67
<class 'str'>
```


### 2.Python读写CSV文件

.csv格式的文件经常用于保存机器学习相关的数据集，比如MNIST等数据集。读写该格式的文件可以借用Pandas库。


#### 2.1 写csv文件：

向.csv文件中写入数据时，首先需要构造一个`DataFrame`类型的数据，如下代码所示，通过传入一个`dict`类型的数据。由于传入的是一个`dict`类型，你所得到的数据的列的顺序可能不否和你的预期，此时可以通过`save[['id', 'name', 'age']]`设置顺序。当得到一个`DataFrame`类型数据上，则可以使用`to_csv()`将其输出，其中参数`index=False`指的是不需要行号。

```Python
import pandas
id = [1,2,3]
name = ['Bob', 'Tom', 'Ada']
age = ['11', '12', '13']
save = pandas.DataFrame({'id': id, 'name': name, 'age' : age})
save = save[['id', 'name', 'age']]
save.to_csv('output.csv',index = False)
```

打开文件'output.csv'可以看到如下样式的表格。

<table class="is-centered is-striped is-bordered is-narrow">
  <tr>
    <th>id</th>
    <th>name</th>
    <th>age</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Bob</td>
    <td>11</td>
  </tr>
  <tr>
    <td>2</td>
    <td>Tom</td>
    <td>12</td>
  </tr>
  <tr>
    <td>3</td>
    <td>Ada</td>
    <td>12</td>
  </tr>
</table>


#### 2.2 读csv文件：

使用`read_csv('input.csv')`读取.csv文件，其中第一个参数为.csv文件的路径,读取出来的数据以DataFrame格式保存。



```Python
import pandas
data = pandas.read_csv('input.csv')
print(data)
print(type(data))
```

```Python
'''输出结果'''
   id name  age
0   1  Bob   11
1   2  Tom   12
2   3  Ada   13
<class 'pandas.core.frame.DataFrame'>
```

可以通过DataFrame中的values属性值得到不带标题数据，该数据是`numpy.ndarray`类型数据，当然可以再通过`tolist()`方法返回`list`类型数据。

```Python
values = data.values
print(values)
print(type(values))
vlist = values.tolist()
print(type(vlist))
```

```Python
'''输出结果'''
[[1 'Bob' 11]
 [2 'Tom' 12]
 [3 'Ada' 13]]
<class 'numpy.ndarray'>
<class 'list'>
```


### 3.Python读写XLS文件（Excel文件）


#### 3.1 写xls文件：

Pandas将xlrd和xlwt进行了封装，使得读写xls文件与读写csv文件类似。如下代码，是对.xls文件写入，使用`pandas.ExcelWriter()`打开一个要写入的.xls文件,然后将`DataFrame`格式的数据保存在打开的.xls文件中，其中`sheet_name`表示写入的sheet的名字。类似的with语句保证了在操作完文件后关闭该文件。

```Python
import pandas
id = [1,2,3]
name = ['Bob', 'Tom', 'Ada']
age = ['11', '12', '13']
save = pandas.DataFrame({'id': id, 'name': name, 'age' : age})
save = save[['id', 'name', 'age']]

with pandas.ExcelWriter('output.xls') as writer:
    save.to_excel(writer, index = False, sheet_name='Sheet1')
```

#### 3.2 读xls文件

使用pandas读取.xls，也很方便，通过`pandas.read_excel()`实现对xls文件读取，其中`sheet_name`指定要读取的sheet。

```Python
import pandas
data = pandas.read_excel('input.xls', sheet_name='Sheet1')
print(data)
print(type(data))
```

```Python
   id name  age
0   1  Bob   11
1   2  Tom   12
2   3  Ada   13
<class 'pandas.core.frame.DataFrame'>
```

若想一次读取xls文件中所有sheet时，可以通过将`sheet_name`设置为`None`来实现。

```Python
import pandas
data = pandas.read_excel('input.xls', sheet_name=None)
print(type(data))
```
```Python
<class 'collections.OrderedDict'>
```

此时可以通过类似遍历字典的方式遍历所有的sheet

```Python
for d in data :
  print(data[d])
```

```Python
   id name  age
0   1  Bob   11
1   2  Tom   12
2   3  Ada   13
```

***

1.参考文档：

&nbsp; &nbsp; &nbsp; &nbsp;[1]. http://pandas.pydata.org/pandas-docs/version/0.24/pandas.pdf